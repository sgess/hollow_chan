\documentclass[aps,prl,preprint,groupedaddress]{revtex4-1}
\usepackage{graphicx}

\newcommand{\webvector}[2]{\left( \begin{array}{c} #1 \\ #2 \end{array} \right)}
\begin{document}
%Title of paper
\title{Hollow channel plasma wakefield acceleration}

\maketitle

\section{Motivation}
We want to create a model of a hollow channel plasma that is relevant for future experiments at FACET. As far as we know, no such model exists.

\section{Questions}
\begin{enumerate}
	\item How does the on-axis $E_z$ field scale with 
	\begin{enumerate}
		\item the channel radius $a$?
		\item the beam density to plasma density 	$n_b/n_0$?
		\item the bunch length $\sigma_z$?
	\end{enumerate}
	\item Are there radial forces inside the channel, despite the fact that there are no ions? Are they linear?
	\item How does the physics change for an electron driver versus a positron driver?
	\item How does beam loading work in the hollow channel? Can positrons be effectively loaded in the channel wake?
	\item How does the physics change for channel profiles that are flat, gaussian and bessel shaped? How does the width of the plasma layer effect the on-axis fields?
	\item How do we describe the sheet crossing of the inner and outer layers of the plasma channel as they converge on the axis? This is especially important for positron beam loading in the second bubble.
\end{enumerate}

\section{Starting point for all models}

We begin with Maxwell's equations in the Lorentz gauge:

\begin{equation}\label{eq:max_wave}
\left( \frac{1}{c^2}\frac{\partial^2}{\partial t^2} - \nabla^2 \right) \webvector{\mathbf{A}}{\phi} = 4\pi \webvector{\mathbf{J/c}}{\rho}
\end{equation}

\begin{equation}\label{eq:gauge}
\frac{1}{c}\frac{\partial \phi}{\partial t} + \nabla \cdot \mathbf{A} = 0
\end{equation}

Next, we make the change of coordinates from $(x, y, z, t)$ to $(x, y, \xi \equiv ct - z, \tau \equiv t)$. In the new coordinates, the derivatives are:

\begin{equation}\label{eq:ddt}
\frac{\partial \phi(x, y, \xi, \tau)}{\partial t} = \frac{\partial \phi}{\partial \tau} \frac{\partial \tau}{\partial t} + \frac{\partial \phi}{\partial \xi} \frac{\partial \xi}{\partial t} = \frac{\partial \phi}{\partial \tau} + c\frac{\partial \phi}{\partial \xi} 
\end{equation}

\begin{equation}\label{eq:ddz}
\frac{\partial \phi(x, y, \xi, \tau)}{\partial z} = \frac{\partial \phi}{\partial \tau} \frac{\partial \tau}{\partial z} + \frac{\partial \phi}{\partial \xi} \frac{\partial \xi}{\partial z} = -\frac{\partial \phi}{\partial \xi} 
\end{equation}

Transforming the left hand side of equations~\ref{eq:max_wave} and~\ref{eq:gauge} we have:

\begin{equation}\label{eq:max_left}
\left( \frac{1}{c^2}\left[\frac{\partial^2}{\partial \tau^2} + c^2\frac{\partial^2}{\partial \xi^2}\right] - \frac{\partial^2}{\partial x^2} - \frac{\partial^2}{\partial y^2} - \frac{\partial^2}{\partial \xi^2}\right) \webvector{\mathbf{A}}{\phi} =  \left( \frac{1}{c^2}\frac{\partial^2}{\partial \tau^2} - \nabla^2_\perp \right) \webvector{\mathbf{A}}{\phi}
\end{equation}

\begin{equation}\label{eq:gauge_left}
\frac{1}{c}\left[\frac{\partial}{\partial \tau} + c\frac{\partial}{\partial \xi}\right]\phi + \frac{\partial A_x}{\partial x} + \frac{\partial A_y}{\partial y} - \frac{\partial A_z}{\partial \xi}  = 0 \rightarrow \frac{1}{c}\frac{\partial \phi}{\partial \tau} + \nabla_\perp \cdot \mathbf{A}_\perp = -\frac{\partial(\phi - A_z)}{\partial \xi}
\end{equation}

where $\nabla_\perp = \partial_x \hat x + \partial_y \hat y$ and $\mathbf{A}_\perp = A_x \hat x + A_y \hat y$. Finally, we apply the quasistatic approximation $\partial_\tau \phi = \partial_\tau \mathbf{A} = 0$. The quasistatic approximation says that the fields change slowly in the co-moving frame. Defining $\psi \equiv \phi - A_z$ and setting $c = 1$, Maxwell's equations in the quasistatic approximation are:

\begin{equation}\label{eq:max_qs}
-\nabla^2_\perp \webvector{\mathbf{A}}{\phi} = \webvector{\mathbf{J}}{\rho}
\end{equation}

\begin{equation}\label{eq:gauge_qs}
\nabla_\perp \cdot \mathbf{A}_\perp = -\frac{\partial \psi}{\partial \xi}
\end{equation}

The pseudopotential $\psi$ obeys the Poisson-like equation

\begin{equation}\label{eq:Poisson}
-\nabla^2_\perp \psi = \rho - J_z
\end{equation}

The continuity equation is

\begin{equation}\label{eq:Cont}
\frac{\partial}{\partial \xi} (\rho - J_z) + \nabla_\perp \cdot J_\perp = 0
\end{equation}

The fields are 

\begin{equation}\label{eq:Ez}
E_z = \frac{\partial \psi}{\partial \xi}
\end{equation} 

\begin{equation}\label{eq:Bz}
B_z = (\nabla_\perp \times A_\perp)\cdot \hat{z}
\end{equation} 

\begin{equation}\label{eq:E_perp}
E_\perp = -\nabla_\perp \phi - \frac{\partial A_\perp}{\partial \xi}
\end{equation}

\begin{equation}\label{eq:B_perp}
B_\perp = \nabla_\perp \times (A_z \hat{z}) + \nabla_z \times A_\perp
\end{equation}

We will rarely make use of equation~\ref{eq:Bz} because we assume that the plasma electrons only have radial motion which means that $\nabla_\perp \times A_\perp = 0$. We will often make use of the first term in equation~\ref{eq:E_perp} and define the``gaussian" electric field as

\begin{equation}\label{eq:E_guass}
E_g = -\nabla_\perp \phi
\end{equation}

This term is especially useful when describing the fields and potentials of the radial charge distribution.

\section{Thin cylinder model}
\subsection{No longitudinal plasma motion}
Here we describe the response of an infinitely thin cylinder of plasma with radius $a$ to a positively charged drive beam. The charge distribution of the electrons in the plasma is given by $\rho = \sigma \delta(r-a)$ where $\sigma$ is the surface charge density. We can also define a line charge density for the plasma as $\lambda_0 = 2\pi a \sigma$. We assume the beam is relativistic and much shorter than the wavelength of the plasma. In this model, the plasma electrons receive an initial kick due to the beam but we do not include the beam current in our description of the plasma response. We also assume that the plasma electrons only move radially. Note that after the beam has passed, $J_z=0$ and therefore $A_z=0$ so $\psi=\phi$.

\begin{figure}[ht]\label{fig:thin_cyl}
  \centering
    \includegraphics[width=150mm]{./figures/thin_cyl.pdf}
      \caption{A thin cylinder plasma with a flat top drive beam.}
\end{figure}

The beam is a flat top with radius $\sigma_r \ll a$, energy $\gamma$, and charge density $n_b$. The beam line charge is $\lambda_b = n_b \pi \sigma_r^2$ and the beam current is:

\begin{equation}\label{eq:I_beam}
I_b = \frac{Q_b}{\sigma_z}c = \frac{n_b \pi \sigma_r^2 \sigma_z}{\sigma_z}c = \lambda_b c
\end{equation}

We can normalize the beam current $I_b$ to the Alfven Current $I_A = m_e c^3/e$ so $\bar{I} = e I_b /m_e c^3$. The quantity $\bar{I} = e \lambda_b/m_e c^2$ is also called the Budker parameter $\nu$. 

Next, we find the beam field at the plasma radius $a$ using Gauss's law:

\begin{equation}\label{eq:E_beam}
E_b = \frac{2 \lambda_b}{a} = \frac{2m_e c^2}{e} \frac{\bar{I}}{a}
\end{equation}

An electron at the plasma radius receives an inward kick $\Delta p = F \Delta t = -e E_b \sigma_z/c$ where $\sigma_z$ is the bunch length. We want to describe the evolution of the plasma after the beam has passed and we also assume that the beam is short compared to the relevant length scale in this problem which is the plasma radius $a$. Let's take $\sigma_z = a/10$ to get:

\begin{equation}\label{eq:norm_kick}
\Delta p = -e \frac{2m_e c^2 \bar{I}}{e}\frac{\sigma_z/c}{a} = -\frac{m_e c \bar{I}}{5}
\end{equation}  

Of course it is completely arbitrary to choose $\sigma_z = a/10$, but this allows us to see that the strength of the kick is really controlled by the peak current and nothing else. 

%We also note that our model does not include radiative effects, so for our model to be reasonably accurate, we should require that the normalized kick $\Delta p/m_e c \ll 1$ which means $\bar{I} \ll 5$. At FACET, $\bar{I} \approx 1$ and $\sigma_z/\lambda_p \approx 1/5$. 

We now seek an equation of motion for the position of the plasma electron sheath $r_s$. We assume the ions are stationary. Even though the plasma cylinder is infinitely thin, we can still introduce a notion of charge shielding by noting that the amount of plasma electrons that participate in the interaction is proportional to the line charge of the beam $\lambda_b = m_e c^2 \bar{I}/e$. Then the plasma line charge interacting with the beam is:

\begin{equation}\label{eq:part_charge}
\lambda_i = \left\{ \begin{array}{lr}
m_e c^2 \bar{I}/e & \lambda_b < \lambda_0 \\
\lambda_0 & \lambda_b > \lambda_0
\end{array} \right.
\end{equation}

For now we assume that $ \lambda_b < \lambda_0 $ which will likely be the case when we move beyond the thin cylinder model.

To solve for $r_s$, we first need to solve for the potential $\psi$. We take $\psi(\infty) = 0$. Outside the cylinder, there is zero net charge (after the drive beam has passed), so Gauss's law gives $E_g(r > a) = 0$ and therefore $\psi(r > a) = const = 0$. Inside the electron sheath there is no charge either, so $E_g(r < r_s) = 0$ and $\psi(r < r_s) = \psi_0$. Between the electron sheath and the ion layer there is a net charge and Gauss's law gives $E_g(r) = -2\bar{I}/r$ for $r_s < r < a$. Note that we normalize $E$ and $\psi$ to $m_e c^2/e$. We can now find the potential by integrating the electric field:

\begin{equation}\label{eq:thin_psi}
\psi(r) = -\int_0^r E(r') dr' = \psi_0 - \int_{r_s}^r \frac{-2\bar{I}}{r'}dr' = \psi_0 - 2\bar{I} \log\left(\frac{r_s}{r}\right)
\end{equation}

Using the boundary condition $\psi(a) = 0$ we find that $\psi_0 = -2\bar{I} \log\left(\frac{a}{r_s}\right)$ so:

\begin{equation}\label{eq:psi_everywhere}
\psi(r) = \left\{ \begin{array}{lr}
-2\bar{I} \log\left(\frac{a}{r_s}\right) & 0<r<r_s \\
-2\bar{I} \log\left(\frac{a}{r_s}\right) - 2\bar{I} \log\left(\frac{r_s}{r}\right) & r_s<r<a \\
0 & a<r
\end{array} \right.
\end{equation}

\begin{figure}[ht]\label{fig:fields}
  \centering
    \includegraphics[width=100mm]{./figures/fields.pdf}
      \caption{$E_g$ and $\psi$ for the thin cylinder model. $\bar{I} = 1$ and distances are normalized to $a=1$.}
\end{figure}

Next, we find $\mathbf{A}_{\perp}$ using equation~\ref{eq:gauge_qs} and assuming that the motion of the plasma electrons is purely radial so $A_z = 0$. Then

\begin{equation}\label{eq:a_perp}
\nabla_\perp \cdot \mathbf{A}_\perp = -\frac{\partial \psi}{\partial \xi} = - \frac{\partial \psi}{\partial r_s}\frac{\partial r_s}{\partial \xi} = -\frac{2\bar{I}}{r_s}r_s'
\end{equation}

We evaluated the derivative $\partial_\xi \psi$ at $r = r_s$. In cylindrical coordinates, the divergence is

\begin{equation}\label{eq:a_perp_cyl}
\nabla_\perp \cdot \mathbf{A}_\perp = \frac{1}{r}\frac{\partial}{\partial r} (r A_r) + \frac{1}{r}\frac{\partial A_{\theta}}{\partial \theta}
\end{equation}

but we drop the $\theta$ term due to the cylindrical symmetry. We note that $r$ and $r_s$ are independent variables in this equation so we can easily integrate the equation in $r$ to find $A_r$

\begin{equation}\label{eq:a_r}
\frac{1}{r}\frac{\partial}{\partial r} (r A_r) = -\frac{2\bar{I}}{r_s}r_s' \rightarrow A_r = -\frac{\bar{I} r r_s'}{r_s}
\end{equation}

At this point, we'd like to start determining some physical quantities of interest, like $E_z$

\begin{equation}\label{eq:E_z}
E_z = \frac{\partial \psi}{\partial \xi} = \frac{2\bar{I}}{r_s}r_s'
\end{equation}

We see that $E_z$ is negative (at least in the first part of the oscillation) because the kick is inward ($r_s' < 0$). Now we need an equation of motion for $r_s$ which we can get by finding the force on the plasma electrons in the sheath:

\begin{equation}\label{eq:force}
F =-(E_r -V_z B_{\theta}) = -E_r
\end{equation}

because we have assumed that $V_z = 0$. The radial field is

\begin{equation}\label{eq:force}
E_r =-\nabla_{\perp} \phi - \frac{\partial A_r}{\partial \xi} = \frac{\bar{I} r}{r_s^2}[r_s r_s'' - r_s'^2]
\end{equation}

with $\nabla_{\perp} \phi = 0$ for the sheath electrons because there is zero charge within the sheath layer. The EOM $\partial_{\xi} P_{\perp} = -E_r$ is rewritten with the ``particle tracking" trajectory $\xi = t - z \rightarrow \partial_{\xi} = (1-v_z)\partial_t$:

\begin{equation}\label{eq:track}
\frac{\partial P_{\perp}}{\partial \xi} = \frac{\partial \gamma v_{\perp}}{\partial \xi} =  \frac{\partial}{\partial \xi}\left(\gamma \frac{\partial r_{\perp}}{\partial t}\right) = \frac{\partial}{\partial \xi}\left[\gamma (1-v_z)\frac{\partial r_{\perp}}{\partial \xi}\right]
\end{equation}

and using the integral of motion $\gamma - P_z = 1 + \psi$

\begin{equation}\label{eq:EOM}
\frac{\partial P_{\perp}}{\partial \xi} = \frac{\partial}{\partial \xi}[(1+\psi)r_s'] = -\frac{\bar{I} r}{r_s^2}[r_s r_s'' - r_s'^2] 
\end{equation}

Plugging in $\psi$ and $r=r_s$ we have:

\begin{equation}\label{eq:rs}
\left(1+\bar{I} + 2\bar{I}\log\left(\frac{r_s}{a}\right) \right)r_s'' +\bar{I}\frac{r_s'^2}{r_s} = 0
\end{equation}

In order to study this equation, let's set $a=1$:

\begin{equation}\label{eq:rs_simp}
[1+\bar{I}(1+2\log(r_s))] r_s r_s'' + \bar{I}r_s'^2 = 0
\end{equation}

Immediately we see that we might run into trouble when $r_s = 0$ due to the divergence in the log term (although $x\log x = 0$ as $x\rightarrow0$).

\begin{figure}[ht]\label{fig:sheath}
  \centering
    \includegraphics[width=100mm]{./figures/sheath.pdf}
      \caption{$r_s$ and $E_z$ for the thin cylinder model. $\bar{I} = 1$ and distances are normalized to $a=1$. The initial kick $r_s'(0) = -0.46$. This is the largest kick that Mathematica can use to solve the equation for the given plot range.}
\end{figure}

\subsection{Adding in longitudinal plasma motion}


\end{document}